<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calorie Calculator ‚Äî Convert Labs</title>
  <meta name="description" content="Search food calories and nutrients instantly. Convert Labs Calorie Calculator uses verified USDA data for accurate results." />
  <meta name="keywords" content="calorie calculator, food nutrition, protein carbs fat sugar, calorie counter, Convert Labs" />
  <link rel="icon" href="../assets/convert-labs-icon.png" />
  <link rel="stylesheet" href="../style.css" />
</head>

<body>
  <!-- ‚úÖ Header -->
  <header class="navbar">
    <div class="nav-container">
      <div class="logo">
        <a href="../index.html">
          <img src="../assets/convert-labs-icon.png" alt="Convert Labs logo" class="logo-img" />
          <span class="brand-text">Convert Labs</span>
        </a>
      </div>
      <nav class="nav-links">
        <ul>
          <li><a href="../index.html">Home</a></li>
          <li><a href="tools.html" class="active">Tools</a></li>
          <li><a href="../guides.html">Blog</a></li>
          <li><a href="../about.html">About</a></li>
          <li><a href="../contact.html">Contact</a></li>
        </ul>
      </nav>
      <button id="themeToggle" class="theme-toggle">üåô</button>
    </div>
  </header>

  <!-- ‚úÖ Main Content -->
  <main class="tool-page" style="max-width:800px;margin:auto;padding:2rem 1rem;">
    <h1>Calorie Calculator</h1>
    <p>
      Type any food name (like <b>ketchup</b>, <b>greek yogurt</b>, <b>rice</b>, or <b>biscuits</b>) to get instant nutrition data.
      Powered by verified <b>USDA food composition</b> for accuracy.
    </p>

    <form id="calorieSearchForm" class="converter" style="margin-top:1.5rem;">
      <input type="text" id="foodQuery" placeholder="Enter a food name (e.g. chicken, mayonnaise)" required />
      <button type="submit">Search</button>
    </form>

    <div id="calorieResult" style="margin-top:2rem; text-align:left;"></div>

    <section style="margin-top:3rem;">
      <h2>About This Tool</h2>
      <p>
        This calorie calculator retrieves real food data from the official USDA nutrient database (2021‚Äì2023 FNDDS).
        Each result includes the energy (kcal) and macronutrients per 100 g of edible portion.
      </p>
      <ul>
        <li>‚ö° <b>Calories (kcal)</b> ‚Äî energy per 100 g</li>
        <li>üçó <b>Protein</b> ‚Äî grams of protein</li>
        <li>üçû <b>Carbs</b> ‚Äî grams of carbohydrate</li>
        <li>üßà <b>Fat</b> ‚Äî grams of total fat</li>
        <li>üç¨ <b>Sugar</b> ‚Äî grams of total sugars</li>
      </ul>
    </section>
  </main>

  <!-- ‚úÖ Footer -->
  <footer class="footer">
    <div class="footer-brand">
      <img src="../assets/convert-labs-icon.png" alt="Convert Labs Icon" class="footer-logo" />
      <span class="footer-text">Convert Labs</span>
    </div>
    <p>¬© 2025 Convert Labs. All rights reserved.</p>
    <nav class="footer-links">
      <a href="../about.html">About</a> |
      <a href="tools.html">Tools</a> |
      <a href="../guides.html">Guides</a> |
      <a href="../privacy.html">Privacy Policy</a> |
      <a href="../terms.html">Terms</a> |
      <a href="../contact.html">Contact</a>
    </nav>
  </footer>

  <!-- ‚úÖ Script -->
  <script src="../script.js" defer></script>
  <script>
  let foodData = [];
  let fullFoodData = [];
  let isFullLoaded = false;

  // === Load lite data first ===
  async function loadFoodData() {
    try {
      const res = await fetch("../assets/foods-lite.json");
      foodData = await res.json();
      console.log("Lite food data loaded (" + foodData.length + " items)");
    } catch (err) {
      console.error("Error loading foods-lite.json:", err);
    }
  }
  loadFoodData();

  // === Load full dataset lazily ===
  async function loadFullData() {
    if (isFullLoaded) return;
    try {
      const res = await fetch("../assets/foods-full.json");
      fullFoodData = await res.json();
      isFullLoaded = true;
      console.log("Full food database loaded ‚úÖ (" + fullFoodData.length + " items)");
    } catch (err) {
      console.error("Error loading foods-full.json:", err);
    }
  }

  // === Find a food in datasets ===
  function findFood(query) {
    query = query.trim().toLowerCase();
    let match = foodData.find(f => f.name.includes(query));

    if (!match && isFullLoaded) {
      match = fullFoodData.find(f => f.name.includes(query));
    }

    // If not found and full data isn't loaded yet
    if (!match && !isFullLoaded) {
      loadFullData().then(() => {
        const found = fullFoodData.find(f => f.name.includes(query));
        if (found) displayFoodResult(found);
        else showNotFound(query);
      });
      return null;
    }

    return match;
  }

  // === Display the found food ===
  function displayFoodResult(food) {
    const result = document.getElementById("calorieResult");
    result.innerHTML = `
      <div class="card" style="padding:1rem;border-radius:10px;background:var(--card-bg);box-shadow:0 2px 5px var(--shadow-color);">
        <h2 style="text-transform:capitalize;">${food.name}</h2>
        <p><b>Calories:</b> ${food.kcal} kcal</p>
        <p><b>Protein:</b> ${food.protein} g</p>
        <p><b>Carbohydrates:</b> ${food.carbs} g</p>
        <p><b>Sugar:</b> ${food.sugar} g</p>
        <p><b>Fat:</b> ${food.fat} g</p>
        <small>Per 100 g (USDA FNDDS 2021‚Äì2023)</small>
      </div>
    `;
  }

  function showNotFound(query) {
    document.getElementById("calorieResult").innerHTML = `
      <p style="color:#b91c1c;">‚ùå No match found for <b>${query}</b>. Try a simpler name or spelling.</p>
    `;
  }

  // === Handle form ===
  document.getElementById("calorieSearchForm").addEventListener("submit", e => {
    e.preventDefault();
    const query = document.getElementById("foodQuery").value;
    const match = findFood(query);
    if (match) displayFoodResult(match);
    else showNotFound(query);
  });
  </script>
</body>
</html>
