<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Image Upscaler ‚Äî Convert Labs</title>
  <meta name="description" content="Upscale and enhance your images instantly online with Convert Labs ‚Äî free, AI-powered image upscaler." />

  <link rel="stylesheet" href="../style.css" />
  <meta name="theme-color" content="#1e40af">

  <!-- Upscaler.js Library -->
  <script src="https://cdn.jsdelivr.net/npm/upscaler@1.1.6/dist/browser/upscaler.min.js"></script>

  <style>
    main {
      max-width: 700px;
      margin: 2rem auto;
      padding: 1rem;
    }
    .upload-box {
      border: 2px dashed #1e40af;
      padding: 2rem;
      border-radius: 10px;
      background: #f9fafc;
    }
    input[type="file"] {
      margin-top: 1rem;
    }
    canvas {
      max-width: 100%;
      border-radius: 10px;
      margin-top: 1rem;
    }
    #status {
      margin-top: 1rem;
      font-weight: 500;
      color: #1e40af;
    }
    .download-btn {
      display: none;
      margin-top: 1rem;
      background: #1e40af;
      color: #fff;
      border: none;
      padding: 0.7rem 1.2rem;
      border-radius: 8px;
      cursor: pointer;
    }
    .download-btn:hover {
      background: #1e3a8a;
    }
  </style>
</head>

<body>
  <header>
    <div class="header-content">
      <a href="../index.html" class="brand" aria-label="Convert Labs home">
        <img src="../assets/convert-labs-icon.png" alt="Convert Labs logo" class="logo">
        <span class="brand-text">Convert Labs</span>
      </a>

      <div class="header-controls">
        <a href="../contact.html" class="header-btn">Contact Us</a>
        <button id="themeToggle" class="theme-toggle" title="Switch Theme">üåô</button>
      </div>
    </div>
  </header>

  <main>
    <h1>‚ú® Image Upscaler</h1>
    <p>Improve your image quality with AI ‚Äî upscale up to 2√ó resolution instantly.</p>

    <div class="upload-box">
      <p><strong>Select an image to upscale:</strong></p>
      <input type="file" id="imageInput" accept="image/*">
      <p id="status"></p>
      <canvas id="resultCanvas"></canvas>
      <button id="downloadBtn" class="download-btn">Download Upscaled Image</button>
    </div>
  </main>

  <footer>
    <p>¬© 2025 Convert Labs</p>
    <div class="footer-links">
      <a href="../about.html">About</a> |
      <a href="../how-to.html">How To</a> |
      <a href="../privacy.html">Privacy</a> |
      <a href="../terms.html">Terms</a> |
      <a href="../contact.html">Contact</a>
    </div>
  </footer>

  <script>
    // Theme toggle
    const toggle = document.getElementById("themeToggle");
    const saved = localStorage.getItem("theme");
    if (saved === "dark") {
      document.body.classList.add("dark-mode");
      toggle.textContent = "‚òÄÔ∏è";
    }
    toggle.addEventListener("click", () => {
      document.body.classList.toggle("dark-mode");
      const dark = document.body.classList.contains("dark-mode");
      toggle.textContent = dark ? "‚òÄÔ∏è" : "üåô";
      localStorage.setItem("theme", dark ? "dark" : "light");
    });

    // UpscalerJS logic
    const upscaler = new window.Upscaler({
      model: 'https://cdn.jsdelivr.net/npm/@upscalerjs/esrgan-thick@1.1.0/weights/1x/model.json'
    });

    const imageInput = document.getElementById('imageInput');
    const status = document.getElementById('status');
    const canvas = document.getElementById('resultCanvas');
    const downloadBtn = document.getElementById('downloadBtn');
    const ctx = canvas.getContext('2d');

    imageInput.addEventListener('change', async (e) => {
      const file = e.target.files[0];
      if (!file) return;
      status.textContent = "Upscaling in progress... please wait ‚è≥";
      downloadBtn.style.display = "none";

      const img = new Image();
      img.src = URL.createObjectURL(file);
      await img.decode();

      try {
        const result = await upscaler.upscale(img);
        canvas.width = result.width;
        canvas.height = result.height;
        ctx.drawImage(result, 0, 0);
        status.textContent = "‚úÖ Upscaling complete!";
        downloadBtn.style.display = "inline-block";

        downloadBtn.onclick = () => {
          const link = document.createElement('a');
          link.download = 'upscaled-image.png';
          link.href = canvas.toDataURL();
          link.click();
        };
      } catch (err) {
        console.error(err);
        status.textContent = "‚ùå Error during upscaling.";
      }
    });
  </script>
</body>
</html>

